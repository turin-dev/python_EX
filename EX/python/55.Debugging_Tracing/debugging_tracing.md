# 55장 – 디버깅과 스택 추적 검사

프로그램이 예기치 않게 동작할 때는 효율적인 디버깅 도구가 매우 중요하다. 파이썬에는 `pdb` 모듈에 대화형 소스 코드 디버거가 있고, 스택 추적을 검사하고 포맷팅하는 `traceback` 모듈이 제공된다. 이러한 도구를 사용하면 실행을 일시 중지하고, 코드를 한 줄씩 따라가며, 변수 값을 확인하고, 오류 정보를 기록해 나중에 분석할 수 있다【637898121780976†L56-L90】【878944216912771†L61-L103】.

## `pdb`로 대화형 디버깅

내장 디버거는 중단점 설정, 한 줄씩 실행, 스택 검사 및 표현식 평가를 지원한다. 특정 지점에서 디버깅을 시작하려면 `pdb.set_trace()`를 삽입하거나 파이썬 3.7에서 추가된 편리한 `breakpoint()` 함수를 호출한다. 인터프리터가 중단점에 도달하면 디버거 REPL에 진입한다. 사용할 수 있는 주요 명령은 다음과 같다:

* `n` / `next` – 다음 줄을 실행하여 함수 호출을 건너뛴다.
* `s` / `step` – 현재 함수 호출 내부로 진입한다.
* `c` / `continue` – 다음 중단점까지 실행을 계속한다.
* `p` – 표현식의 값을 출력한다.
* `q` – 디버거를 종료한다.

또한 `python -m pdb script.py` 명령으로 전체 스크립트를 디버거에서 실행할 수 있다. 이 명령은 프로그램 시작 지점에 자동으로 중단점을 설정하고 처리되지 않은 예외에서 중지한다【637898121780976†L56-L90】.

## 스택 추적 캡처 및 포맷팅

`traceback` 모듈은 예외 트레이스백이나 현재 실행 스택에서 스택 추적을 추출하고 포맷하여 출력하는 함수들을 제공한다. 기본 인터프리터 출력 대신 원하는 형태로 추적을 포맷팅하여 로그나 오류 보고서에 사용할 수 있다. 예를 들어 `traceback.format_exc()`는 가장 최근 예외의 트레이스백을 문자열로 반환하고, `traceback.print_exception()`은 예외와 스택을 파일 객체에 출력한다【878944216912771†L61-L103】. 코드의 임의 위치에서 스택을 출력하려면 `traceback.print_stack()`을 호출한다.

예제 사용법:

```python
import traceback

try:
    1 / 0
except ZeroDivisionError:
    # 전체 트레이스백을 문자열로 캡처
    tb_str = traceback.format_exc()
    print("Captured traceback:\n", tb_str)

    # 또는 표준 출력으로 바로 출력
    traceback.print_exc()
```

## 요약

실행을 일시 중지하고 상호작용적으로 프로그램 상태를 조사하려면 `pdb`나 고수준의 `breakpoint()` 내장 함수를 사용하라【637898121780976†L56-L90】. 로그나 사용자에게 보여줄 메시지에 스택 추적을 포함해야 할 때는 `traceback` 모듈의 함수를 사용해 예외 정보를 추출하고 포맷팅하라【878944216912771†L61-L103】.