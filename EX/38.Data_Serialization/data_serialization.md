# 데이터 직렬화: Pickle, Shelve, Configparser

데이터를 파일로 저장하거나 네트워크를 통해 전송할 때는 **직렬화(Serialization)** 과정을 거쳐야 합니다. 파이썬 표준 라이브러리는 여러 직렬화 포맷을 제공합니다. 텍스트 기반 형식으로는 앞서 다룬 `json`과 `csv`가 있고, 이 장에서는 바이트 기반 형식과 구성 파일을 살펴봅니다.

## Pickle

`pickle` 모듈은 파이썬 객체 구조를 바이트 스트림으로 변환하는 바이너리 직렬화 프로토콜을 구현합니다. **피클링**은 객체를 바이트 스트림으로 변환하는 과정이며, **언피클링**은 반대 과정입니다【240875860392566†L73-L80】. 피클은 대부분의 파이썬 내장 타입과 사용자 정의 클래스 인스턴스를 저장할 수 있지만, 보안이 보장되지 않습니다. 문서에서 명시하듯이 피클은 **안전하지 않으며 신뢰할 수 없는 데이터에 사용해서는 안 됩니다**【240875860392566†L84-L88】. 악의적으로 조작된 피클 데이터를 로드할 경우 임의의 코드가 실행될 수 있으므로, 반드시 안전한 소스에서만 로드해야 합니다.

## Shelve

`shelve` 모듈은 피클을 기반으로 간단한 **키-값 데이터베이스**를 제공합니다. 딕셔너리처럼 사용하지만, 값은 자동으로 피클되어 파일에 저장됩니다. 여러 스크립트에서 동일한 파일을 열어 데이터를 공유할 수 있으며, 작은 프로젝트에서 간편한 퍼시스턴스 용도로 유용합니다. 단, 내부적으로 `pickle`을 사용하므로 앞서 언급한 보안 주의사항이 동일하게 적용됩니다.

## ConfigParser / TOML

애플리케이션 설정을 위해 사람이 읽을 수 있는 구성 파일이 필요할 때는 `configparser` 모듈을 사용하면 INI 형식의 설정 파일을 읽고 쓸 수 있습니다. 섹션과 키-값 쌍으로 데이터를 저장하며, 문자열 기반 형식이므로 간단한 설정에 적합합니다. 파이썬 3.11부터는 표준 라이브러리에 `tomllib`가 포함되어 TOML 형식의 읽기 기능을 제공합니다. TOML은 중첩된 구조와 자료형을 더 명확하게 표현할 수 있어 복잡한 설정 파일을 다루기에 적합합니다.

## 요약

* `pickle`은 객체를 바이트 스트림으로 저장하는 편리한 도구지만, 보안 위험 때문에 신뢰할 수 있는 데이터에만 사용해야 합니다【240875860392566†L73-L80】【240875860392566†L84-L88】.
* `shelve`는 간단한 키-값 데이터베이스를 제공하며 내부적으로 피클을 사용합니다.
* `configparser`와 `tomllib`는 사람이 읽을 수 있는 설정 파일을 다루기에 적합합니다. 복잡한 설정에는 TOML을 고려해 볼 수 있습니다.

---

### 참고 문헌

1. `pickle` 모듈은 파이썬 객체 구조를 직렬화/역직렬화하는 바이너리 프로토콜을 제공하며, 이를 피클링과 언피클링이라고 부른다【240875860392566†L73-L80】.
2. 피클은 악의적으로 조작된 데이터를 로드할 경우 임의의 코드 실행을 유발할 수 있으므로 신뢰할 수 없는 데이터에 사용하지 말아야 한다【240875860392566†L84-L88】.